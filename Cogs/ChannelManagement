import discord
from discord.ext import commands

class ChannelManagement(commands.Cog):
    def __init__(self, bot):
        self.bot = bot

    @commands.command()
    @commands.has_any_role("Cohort 5", "Cohort 6", "Cohort 7", "Cohort 8")
    async def createchannel(self, ctx, users: commands.Greedy[discord.Member], channel_name):
        guild = ctx.guild
        overwrites = {
            guild.default_role: discord.PermissionOverwrite(read_messages=False),
            guild.me: discord.PermissionOverwrite(read_messages=True)
        }
        for user in users:
            overwrites[user] = discord.PermissionOverwrite(read_messages=True)
        channel = await guild.create_text_channel(channel_name, overwrites=overwrites)
        await ctx.send(f"Channel '{channel_name}' created successfully!")

    @commands.command()
    @commands.has_any_role("Cohort 5", "Cohort 6", "Cohort 7", "Cohort 8")
    async def invite(self, ctx, user: discord.Member):
        await ctx.send(f"Invited {user.name} to the channel!")

    @commands.command()
    @commands.has_any_role("Cohort 5", "Cohort 6", "Cohort 7", "Cohort 8")
    async def delete(self, ctx, channel_name):
        channel = discord.utils.get(ctx.guild.text_channels, name=channel_name)
        if channel is None:
            await ctx.send(f"Channel '{channel_name}' does not exist!")
            return
        if channel.created_by != ctx.author:
            await ctx.send("You can only delete channels that you have created!")
            return
        await channel.delete()
        await ctx.send(f"Channel '{channel_name}' deleted successfully!")

def setup(bot):
    bot.add_cog(ChannelManagement(bot))